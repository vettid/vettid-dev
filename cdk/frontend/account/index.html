<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta http-equiv="X-Content-Type-Options" content="nosniff"/>
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin"/>
<title>VettID â€¢ Account</title>
<link rel="icon" type="image/jpeg" href="/assets/favicon.ico"/>
<!-- Self-hosted fonts -->
<link rel="stylesheet" href="/assets/fonts.css"/>
<link rel="stylesheet" href="/assets/styles.css"/>
<style>
    /* Warm dark palette */
    :root {
      --bg-card: #12110f;
      --bg-hover: #1f1d1a;
      --bg-sidebar: linear-gradient(180deg,#14120f 0%,#0a0908 100%);
      --bg-header: linear-gradient(135deg,#1a1816 0%,#12110f 100%);
      --bg-modal: #1a1816;
      --bg-input: #0d0c0a;
      --bg-skeleton-from: #0a0908;
      --bg-skeleton-mid: #1a1816;
      --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
      --duration-fast: 150ms;
      --duration-normal: 200ms;
      --duration-slow: 300ms;
    }
    /* Light theme overrides */
    [data-theme="light"] {
      --bg-card: #ffffff;
      --bg-hover: #f5f5f4;
      --bg-sidebar: linear-gradient(180deg,#f5f5f4 0%,#e7e5e4 100%);
      --bg-header: linear-gradient(135deg,#ffffff 0%,#fafaf9 100%);
      --bg-modal: #ffffff;
      --bg-input: #fafaf9;
      --bg-skeleton-from: #e7e5e4;
      --bg-skeleton-mid: #f5f5f4;
    }
    *{box-sizing:border-box;}
    body{display:flex;flex-direction:column;height:100vh;margin:0;overflow:hidden;}
    header{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:var(--bg-header);border-bottom:2px solid var(--accent);box-shadow:0 2px 8px rgba(0,0,0,0.3);flex-shrink:0;}
    .main-container{display:flex;flex:1;overflow:hidden;}
    .sidebar{width:220px;background:var(--bg-sidebar);border-right:2px solid #2a2622;display:flex;flex-direction:column;overflow-y:auto;transition:width var(--duration-normal) var(--ease-out-expo);position:relative;flex-shrink:0;}
    .sidebar.collapsed{width:0;overflow:hidden;border-right:none;}
    .sidebar-toggle{position:fixed;top:50%;left:220px;transform:translateY(-50%);background:var(--accent);border:none;width:32px;height:48px;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.3);color:#000;font-size:1.2rem;font-weight:bold;border-radius:0 4px 4px 0;z-index:1000;display:flex;align-items:center;justify-content:center;transition:left 0.3s ease;}
    .sidebar.collapsed ~ .sidebar-toggle{left:0;border-radius:4px 0 0 4px;}
    .wrap{padding:20px 32px;flex:1;overflow-y:auto;max-width:none;width:100%;}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .card{padding:24px;background:var(--bg-card);border-radius:8px;border:2px solid var(--border);margin-bottom:20px;transition:border-color var(--duration-normal) var(--ease-out-expo);}
    .card.double-width{grid-column:span 2;}
    .tabs{display:flex;flex-direction:column;gap:0;padding:12px 0;}
    .tab{background:none;color:var(--gray);border:none;padding:14px 20px;cursor:pointer;transition:all .2s;border-left:3px solid transparent;text-align:left;font-weight:600;font-size:0.9rem;width:100%;}
    .tab:hover:not(.locked){color:var(--text);background:rgba(255,193,37,0.08)}
    .tab.active{color:var(--accent);border-left-color:var(--accent);background:rgba(255,193,37,0.12)}
    .tab-parent{position:relative;display:flex;justify-content:space-between;align-items:center;}
    .tab-parent .tab-text{flex:1;}
    .tab-parent .tab-chevron{transition:transform 0.2s ease;font-size:0.8rem;margin-right:4px;}
    .tab-parent.expanded .tab-chevron{transform:rotate(90deg);}
    .tab-children{max-height:0;overflow:hidden;transition:max-height 0.3s ease;background:rgba(0,0,0,0.3);}
    .tab-children.expanded{max-height:500px;}
    .tab-child{padding-left:36px;font-size:0.85rem;min-height:44px;display:flex;align-items:center;}
    .tab-child:hover{background:rgba(255,193,37,0.06);}
    .tab-child.active{color:var(--accent);border-left-color:var(--accent);background:rgba(255,193,37,0.1);}
    .sub-tab-content{display:none;}
    .sub-tab-content.active{display:block;}
    .tab.locked{opacity:0.5;cursor:not-allowed;position:relative}
    .tab.locked::after{content:'ðŸ”’';margin-left:6px;font-size:0.7rem}
    .sidebar-badge{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 5px;margin-left:8px;background:#ef4444;color:#fff;font-size:0.7rem;font-weight:700;border-radius:9px;line-height:1;}
    .sidebar-badge.pulse{animation:badgePulse 2s infinite;}
    @keyframes badgePulse{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,0.4);}50%{box-shadow:0 0 0 6px rgba(239,68,68,0);}}
    .tab.locked::before{content:attr(data-tooltip);position:absolute;left:100%;top:50%;transform:translateY(-50%);margin-left:12px;padding:8px 12px;background:linear-gradient(135deg,#1a1816 0%,#0a0908 100%);color:var(--text);border:2px solid var(--accent);border-radius:6px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity var(--duration-normal) var(--ease-out-expo);font-size:0.85rem;font-weight:600;z-index:1000;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
    .tab.locked:hover::before{opacity:1;}
    .tab-content{display:none;height:100%;width:100%;}
    .tab-content.active{display:block;width:100%;}
    @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
    @keyframes slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(100%);opacity:0}}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    /* Toggle Switch Styles */
    .toggle-switch{position:relative;display:inline-block;width:50px;height:24px;}
    .toggle-switch input{opacity:0;width:0;height:0;}
    .toggle-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#4b5563;transition:.3s;border-radius:24px;}
    .toggle-slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background:#fff;transition:.3s;border-radius:50%;}
    input:checked+.toggle-slider{background:linear-gradient(135deg,#4caf50 0%,#2e7d32 100%);}
    input:checked+.toggle-slider:before{transform:translateX(26px);}
    input:disabled+.toggle-slider{opacity:0.5;cursor:not-allowed;}
    .skeleton{background:linear-gradient(90deg,var(--bg-skeleton-from) 25%,var(--bg-skeleton-mid) 50%,var(--bg-skeleton-from) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;}
    @keyframes shimmer{0%{background-position:200% 0;}100%{background-position:-200% 0;}}

    /* Tooltip Styles */
    .tooltip{position:relative;}
    .tooltip::before{content:attr(data-tooltip);position:absolute;left:100%;top:50%;transform:translateY(-50%);margin-left:12px;padding:8px 12px;background:linear-gradient(135deg,#1a1816 0%,#0a0908 100%);color:var(--text);border:2px solid var(--accent);border-radius:6px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity var(--duration-normal) var(--ease-out-expo);font-size:0.85rem;font-weight:600;z-index:1000;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
    .tooltip::after{content:'';position:absolute;left:100%;top:50%;transform:translateY(-50%);margin-left:6px;border:6px solid transparent;border-right-color:var(--accent);opacity:0;pointer-events:none;transition:opacity 0.2s;z-index:1000;}
    .tooltip:hover::before,.tooltip:hover::after{opacity:1;}

    /* Modal close button */
    .modal-close-btn{background:none;border:none;color:var(--gray);font-size:1.5rem;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all 0.2s;}
    .modal-close-btn:hover{background:rgba(255,193,37,0.1);color:var(--accent);}

    /* Mobile menu button - hidden on desktop */
    .mobile-menu-btn{display:none;align-items:center;justify-content:center;background:none;border:none;color:var(--accent);font-size:1.5rem;cursor:pointer;padding:8px;margin-right:8px;}
    .sidebar-overlay{display:none;}

    @media (max-width: 768px){
      .grid{grid-template-columns:1fr}
      .main-container{flex-direction:row;}
      .sidebar{position:fixed;left:0;top:0;bottom:0;width:260px;z-index:999;transform:translateX(-100%);transition:transform var(--duration-slow) var(--ease-out-expo);border-right:2px solid #2a2622;padding-top:70px;}
      .sidebar.mobile-open{transform:translateX(0);}
      .sidebar-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:998;}
      .sidebar-overlay.visible{display:block;}
      .sidebar-toggle{display:none;}
      .mobile-menu-btn{display:flex !important;}
      .tabs{flex-direction:column;flex-wrap:nowrap;}
      .tab{width:100%;font-size:0.95rem;padding:16px 20px;border-left:3px solid transparent;border-bottom:none;}
      .tab.active{border-left-color:var(--accent);border-bottom-color:transparent;}
      .tab-child{min-height:48px;padding:16px 20px 16px 40px;}
      .tab-parent{min-height:48px;padding:16px 20px;}
      .tab-children.expanded{max-height:500px;}
      header{flex-direction:row;gap:8px;padding:12px 16px;overflow:visible;}
      header h1{font-size:1.1rem;}
      header .btn{padding:8px 12px;font-size:0.85rem;}
      #userEmail{font-size:0.8rem;max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
      .user-dropdown{flex-shrink:1;min-width:0;overflow:visible;}
      .user-dropdown-menu{left:auto;right:0;}
      .wrap{padding:16px;overflow-x:hidden;-webkit-overflow-scrolling:touch;}
      #getting-started{max-width:100%;overflow-x:hidden;}
      #gettingStartedSteps{max-width:100%;overflow-x:hidden;}
      #gettingStartedSteps > div{max-width:100%;box-sizing:border-box;word-wrap:break-word;}

      /* Mobile tab content scrolling fix */
      .tab-content{height:auto !important;}
      .tab-content.active{overflow-y:visible;}
      .sub-tab-content{max-height:none;}
      .card{overflow:visible;}

      /* Mobile Modal Improvements */
      #pinDisableModal > div {
        width: 95% !important;
        max-width: 95% !important;
        max-height: 85vh !important;
        transform: translate(-50%, -50%) !important;
      }

      #pinDisableModal > div > div:first-child {
        padding: 16px !important;
      }

      #pinDisableModal > div > div:nth-child(2) {
        padding: 16px !important;
      }

      #pinDisableModal > div > div:last-child {
        padding: 12px 16px !important;
        flex-direction: column;
      }

      #pinDisableModal > div > div:last-child button {
        width: 100%;
        padding: 14px 24px !important;
        font-size: 1rem;
        min-height: 48px;
      }

      #pinDisableInput {
        font-size: 16px !important;
        padding: 14px !important;
        min-height: 48px;
      }

      #pinDisableModal h3 {
        font-size: 1.1rem !important;
      }

      #pinDisableModal button[data-action="closePinDisableModal"] {
        font-size: 1.8rem !important;
        width: 40px !important;
        height: 40px !important;
      }

      /* Enrollment QR Modal - mobile responsive */
      #enrollmentModal > div {
        width: calc(100% - 24px) !important;
        max-width: none !important;
        padding: 20px 16px !important;
        margin: 12px !important;
      }
      #enrollmentModal h3 {
        font-size: 1.1rem !important;
      }
      #enrollmentModal p {
        font-size: 0.85rem !important;
      }
      #enrollmentQRCode {
        width: 160px !important;
        height: 160px !important;
      }
      #enrollmentQRCode canvas,
      #enrollmentQRCode img {
        width: 160px !important;
        height: 160px !important;
      }
      #enrollmentModal a[href*="vettid"],
      #enrollmentModal button#copyEnrollLink {
        padding: 10px 14px !important;
        font-size: 0.85rem !important;
      }
      /* Stack the Open in App and Copy Link buttons on mobile */
      #enrollmentModal > div > div:nth-child(3) {
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
        align-items: center !important;
      }
      #enrollmentModal button#copyEnrollLink {
        margin-left: 0 !important;
        width: 100% !important;
        max-width: 200px !important;
      }

      /* Cancel Enrollment Modal - mobile responsive */
      #cancelEnrollmentModal {
        padding: 12px !important;
      }
      #cancelEnrollmentModal > div {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 20px 16px !important;
      }
      #cancelEnrollmentModal h3 {
        font-size: 1.1rem !important;
      }
      #cancelEnrollmentModal p {
        font-size: 0.85rem !important;
      }
      #cancelEnrollmentModal button {
        width: 100% !important;
        padding: 14px 20px !important;
        font-size: 0.95rem !important;
      }

      /* Fix subscription cards on mobile - stack vertically */
      #subscriptionOptionsSection > div > div {
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 16px !important;
        padding: 16px !important;
        text-align: center !important;
      }
      /* Name/description section */
      #subscriptionOptionsSection > div > div > div:first-of-type {
        text-align: center !important;
        order: 1;
      }
      #subscriptionOptionsSection > div > div > div:first-of-type h4 {
        font-size: 1.3rem !important;
        margin-bottom: 8px !important;
      }
      #subscriptionOptionsSection > div > div > div:first-of-type p {
        margin-bottom: 12px !important;
      }
      /* Price section */
      #subscriptionOptionsSection > div > div > div:nth-of-type(2) {
        text-align: center !important;
        min-width: unset !important;
        order: 2;
        padding: 12px 0;
        border-top: 1px solid #333;
        border-bottom: 1px solid #333;
      }
      /* Subscribe button */
      #subscriptionOptionsSection .subscription-btn {
        width: 100% !important;
        padding: 16px 24px !important;
        font-size: 1rem !important;
        order: 3;
      }
      /* Popular badge positioning */
      #subscriptionOptionsSection > div > div > div[style*="position:absolute"] {
        left: 50% !important;
        transform: translateX(-50%) !important;
      }

      /* Add bottom padding to all tab content for mobile visibility */
      .tab-content {
        padding-bottom: 100px !important;
      }
      .wrap {
        padding-bottom: 120px !important;
      }
      #subscription {
        padding-bottom: 120px !important;
      }
      #subscriptionOptionsSection {
        padding-bottom: 80px !important;
      }
    }

    /* User dropdown styles */
    .user-dropdown{position:relative;display:inline-block;}
    .user-dropdown-btn{cursor:pointer;display:flex;align-items:center;gap:6px;padding:6px 12px;border-radius:6px;transition:background var(--duration-normal) var(--ease-out-expo);}
    .user-dropdown-btn:hover{background:rgba(255,193,37,0.1);}
    .user-dropdown-menu{display:none;position:absolute;top:100%;right:0;margin-top:8px;background:#1a1816;border:2px solid var(--accent);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.4);min-width:200px;z-index:1000;}
    .user-dropdown-menu.active{display:block;}
    .user-dropdown-item{display:block;width:100%;padding:12px 16px;cursor:pointer;transition:background var(--duration-normal) var(--ease-out-expo);border-bottom:1px solid #2a2622;color:var(--text);font-size:0.9rem;}
    .user-dropdown-item:last-child{border-bottom:none;}
    .user-dropdown-item:hover{background:rgba(255,193,37,0.1);}

    /* Light theme CSS variables */
    [data-theme="light"] {
      --bg-body: #f5f5f5;
      --bg-input: #f9fafb;
      --bg-card: #ffffff;
      --bg-hover: #f3f4f6;
      --bg-tertiary: #e5e7eb;
      --bg-progress: #d1d5db;
      --bg-error-bg: #fee2e2;
      --bg-button-secondary: #e5e7eb;
      --bg-button-disabled: #d1d5db;
      --bg-logs: #f3f4f6;
      --bg-divider: #d1d5db;
      --bg-skeleton: linear-gradient(90deg,#e5e7eb 25%,#f3f4f6 50%,#e5e7eb 75%);
      --text-primary: #1f2937;
      --text-secondary: #4b5563;
      --border-color: #d1d5db;
    }
    [data-theme="light"] body { background: var(--bg-body); color: var(--text-primary); }
    [data-theme="light"] .card { background: var(--bg-card); border-color: var(--border-color); color: var(--text-primary); }
    [data-theme="light"] .tab { color: var(--text-secondary); }
    [data-theme="light"] .tab:hover:not(.locked) { background: rgba(0,0,0,0.05); color: var(--text-primary); }
    [data-theme="light"] .tab.active { color: var(--accent); background: rgba(255,193,37,0.15); }
    [data-theme="light"] .tab-children { background: rgba(0,0,0,0.03); }
    [data-theme="light"] .tab-child:hover { background: rgba(0,0,0,0.05); }
    [data-theme="light"] .wrap { background: var(--bg-body); }
    [data-theme="light"] h1, [data-theme="light"] h2, [data-theme="light"] h3, [data-theme="light"] h4 { color: var(--text-primary); }
    [data-theme="light"] p, [data-theme="light"] span, [data-theme="light"] label { color: var(--text-secondary); }
    [data-theme="light"] input, [data-theme="light"] select, [data-theme="light"] textarea { background: var(--bg-input); color: var(--text-primary); border-color: var(--border-color); }
    [data-theme="light"] .skeleton { background: var(--bg-skeleton); background-size: 200% 100%; }
    [data-theme="light"] .toggle-slider { background: #9ca3af; }
    [data-theme="light"] .sidebar-toggle { background: var(--accent); color: #000; border-color: var(--border-color); }
    [data-theme="light"] .mobile-menu-btn { color: var(--accent); }

    /* Theme toggle button styles */
    .theme-toggle{background:none;border:2px solid var(--accent);border-radius:50%;width:36px;height:36px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.1rem;transition:all 0.2s;color:var(--accent);}
    .theme-toggle:hover{background:rgba(255,193,37,0.15);}

    /* Comprehensive light theme overrides */
    [data-theme="light"] header { background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%); border-bottom-color: #d4a012; }
    [data-theme="light"] header h1 { color: var(--text-primary); }
    [data-theme="light"] .sidebar { background: linear-gradient(180deg, #ffffff 0%, #f5f5f5 100%); border-right-color: var(--border-color); }
    [data-theme="light"] .tab-children { background: rgba(0,0,0,0.02); }
    [data-theme="light"] .user-dropdown-menu { background: #ffffff; border-color: #d4a012; box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    [data-theme="light"] .user-dropdown-item { color: var(--text-primary); border-bottom-color: var(--border-color); }
    [data-theme="light"] .user-dropdown-item:hover { background: rgba(212,160,18,0.1); }
    [data-theme="light"] .user-dropdown-btn span { color: #b8860b !important; }
    [data-theme="light"] #userEmail { color: #b8860b !important; }
    [data-theme="light"] code { background: #e5e7eb; color: var(--text-primary); }

    /* Light theme data boxes and tiles */
    [data-theme="light"] #overallProgress { background: var(--bg-card) !important; border-color: var(--border-color) !important; }
    [data-theme="light"] #overallProgress > div:last-child { background: #e5e7eb !important; }
    [data-theme="light"] #gettingStartedSteps > div { background: var(--bg-card) !important; border-color: var(--border-color) !important; }
    [data-theme="light"] #membershipStatusBox { background: var(--bg-card) !important; border: 1px solid var(--border-color); }
    [data-theme="light"] #profileSubscriptionStatus { background: var(--bg-card) !important; border: 1px solid var(--border-color); }
    [data-theme="light"] #pinStatusBox { background: var(--bg-card) !important; border: 1px solid var(--border-color); }
    [data-theme="light"] #emailPrefsBox { background: var(--bg-card) !important; border: 1px solid var(--border-color); }
    /* Membership terms - default dark theme */
    #termsTextBox { background: #0a0908; color: #e5e5e5; }
    /* Membership terms - light theme */
    html[data-theme="light"] #termsTextBox { background: #ffffff !important; border-color: #d1d5db !important; color: #1f2937 !important; }
    html[data-theme="light"] #termsTextBox pre { color: #1f2937 !important; background: transparent !important; }
    html[data-theme="light"] #termsTextBox * { color: #1f2937 !important; }
    html[data-theme="light"] #membershipTermsSection { color: #1f2937 !important; }
    html[data-theme="light"] #membershipTermsSection > div { background: #f3f4f6 !important; border-color: #d1d5db !important; }
    html[data-theme="light"] #membershipTermsSection label { color: #1f2937 !important; }
    html[data-theme="light"] #memberInfoSection { color: #1f2937 !important; }
    html[data-theme="light"] #memberInfoSection > div { background: #ffffff !important; border-color: #d1d5db !important; }
    html[data-theme="light"] #memberInfoSection p { color: #1f2937 !important; }

    /* Subscription options light theme */
    [data-theme="light"] #subscriptionOptionsSection div[style*="background:#050505"] { background: var(--bg-card) !important; border-color: var(--border-color) !important; }
    /* Current subscription details light theme */
    html[data-theme="light"] #currentSubscriptionDetails > div { background: #ffffff !important; border-color: #d4a012 !important; }
    html[data-theme="light"] #currentSubscriptionDetails p { color: #1f2937 !important; }

    /* Vault services coming soon tiles */
    [data-theme="light"] #vault-deploy div[style*="background:#050505"],
    [data-theme="light"] #vault-byov div[style*="background:#050505"],
    [data-theme="light"] #vault-backup div[style*="background:#050505"] { background: var(--bg-hover) !important; border-color: var(--border-color) !important; }

    /* Modal light theme */
    [data-theme="light"] #enablePinModal > div,
    [data-theme="light"] #updatePinModal > div,
    [data-theme="light"] #pinDisableModal > div > div,
    [data-theme="light"] #confirmModal > div > div,
    [data-theme="light"] #alertModal > div > div,
    [data-theme="light"] #membershipConfirmModal > div > div { background: var(--bg-card) !important; }
    [data-theme="light"] #enablePinModal input,
    [data-theme="light"] #updatePinModal input,
    [data-theme="light"] #pinDisableModal input { background: var(--bg-input) !important; color: var(--text-primary) !important; border-color: var(--border-color) !important; }
    /* Modal cancel buttons in light theme */
    html[data-theme="light"] #membershipConfirmModal button[style*="background:#333"],
    html[data-theme="light"] #confirmModal button[style*="background:#333"],
    html[data-theme="light"] #alertModal button[style*="background:#333"] { background: #e5e7eb !important; color: #1f2937 !important; border: 1px solid #d1d5db !important; }
    html[data-theme="light"] #membershipConfirmModal > div { background: linear-gradient(135deg,#ffffff 0%,#f5f5f5 100%) !important; }
    html[data-theme="light"] #membershipConfirmModal p { color: #1f2937 !important; }
    html[data-theme="light"] #membershipConfirmModal div[style*="border-top"],
    html[data-theme="light"] #membershipConfirmModal div[style*="border-bottom"] { border-color: #d1d5db !important; }

    /* Sidebar active state in light theme - make it more visible */
    [data-theme="light"] .tab.active { color: #b8860b; background: rgba(212,160,18,0.15); border-left-color: #d4a012; }
    [data-theme="light"] .tab-child.active { color: #b8860b; background: rgba(212,160,18,0.12); border-left-color: #d4a012; }
    [data-theme="light"] .tab:hover:not(.locked) { color: var(--text-primary); background: rgba(212,160,18,0.08); }
    [data-theme="light"] .tab-child:hover { background: rgba(212,160,18,0.06); }

    /* Light theme comprehensive inline style overrides */
    /* Secondary buttons (background:#333) */
    [data-theme="light"] button[style*="background:#333"],
    [data-theme="light"] .btn[style*="background:#333"] { background: #e5e7eb !important; color: #1f2937 !important; }
    [data-theme="light"] button[style*="background:#333"]:hover,
    [data-theme="light"] .btn[style*="background:#333"]:hover { background: #d1d5db !important; }
    /* Card-like containers */
    [data-theme="light"] div[style*="background:var(--bg-card)"],
    [data-theme="light"] div[style*="background:var(--bg-card)"],
    [data-theme="light"] div[style*="background:#050505"] { background: var(--bg-card) !important; }
    /* Modal backgrounds */
    [data-theme="light"] div[style*="background:var(--bg-card)"] { background: var(--bg-card) !important; }
    /* Input fields */
    [data-theme="light"] input[style*="background:var(--bg-card)"],
    [data-theme="light"] textarea[style*="background:var(--bg-card)"] { background: var(--bg-input) !important; color: var(--text-primary) !important; }
    /* Borders */
    [data-theme="light"] *[style*="border:1px solid var(--border)"],
    [data-theme="light"] *[style*="border:2px solid #222"],
    [data-theme="light"] *[style*="border:1px solid var(--border)"] { border-color: var(--border-color) !important; }
    [data-theme="light"] *[style*="border-top:1px solid var(--border)"],
    [data-theme="light"] *[style*="border-top:2px solid #222"],
    [data-theme="light"] *[style*="border-top:1px solid #333"] { border-top-color: var(--border-color) !important; }
    [data-theme="light"] *[style*="border-bottom:1px solid var(--border)"],
    [data-theme="light"] *[style*="border-bottom:2px solid #222"],
    [data-theme="light"] *[style*="border-bottom:1px solid #333"] { border-bottom-color: var(--border-color) !important; }
    /* Progress bar backgrounds */
    [data-theme="light"] div[style*="background:#222"] { background: #e5e7eb !important; }
    /* Health dashboard and status boxes */
    [data-theme="light"] #vaultHealthContent > div,
    [data-theme="light"] #byovStatusContent > div { background: var(--bg-card) !important; border-color: var(--border-color) !important; }
    /* BYOV form inputs */
    [data-theme="light"] #byovServiceUrl,
    [data-theme="light"] #byovApiKey,
    [data-theme="light"] #byovHealthEndpoint { background: var(--bg-input) !important; color: var(--text-primary) !important; border-color: var(--border-color) !important; }
    /* Credential backup sections */
    [data-theme="light"] #credentialBackupStatusContent > div { background: var(--bg-card) !important; border-color: var(--border-color) !important; }
    [data-theme="light"] #recoveryPhraseDisplay { background: var(--bg-input) !important; color: var(--text-primary) !important; }
    [data-theme="light"] #recoveryPhraseInput,
    [data-theme="light"] #restorePassword { background: var(--bg-input) !important; color: var(--text-primary) !important; border-color: var(--border-color) !important; }
  </style>
</head>
<body>
<header>
<div style="display:flex;align-items:center;gap:12px;">
  <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu">&#9776;</button>
  <img alt="VettID logo" src="/assets/logo.jpg" style="height:36px;width:36px;border-radius:6px;"/>
  <h1>Account</h1>
</div>
<div id="userDropdownContainer" class="user-dropdown" style="display:none;">
  <div class="user-dropdown-btn">
    <span id="userEmail" style="color:var(--accent);font-weight:600;"></span>
    <span style="font-size:0.7rem;">&#9660;</span>
  </div>
  <div id="userDropdownMenu" class="user-dropdown-menu">
    <div class="user-dropdown-item" id="themeToggle" style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
      <span>Theme</span>
      <span id="themeIcon" style="font-size:1.1rem;">&#9728;&#65039;</span>
    </div>
    <div class="user-dropdown-item" id="signout">Sign Out</div>
  </div>
</div>
</header>
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<div class="main-container">
  <div class="sidebar" id="sidebar">
    <div class="tabs">
      <button class="tab active" data-tab="getting-started">Getting Started</button>
      <button class="tab tab-parent" id="accountParent" data-tab="account">
        <span class="tab-text">Account</span>
        <span class="tab-chevron">&#9656;</span>
      </button>
      <div class="tab-children" id="accountChildren">
        <button class="tab tab-child" data-tab="account" data-sub-tab="profile">Profile</button>
        <button class="tab tab-child" data-tab="account" data-sub-tab="membership">Membership</button>
        <button class="tab tab-child" data-tab="account" data-sub-tab="pin-code">PIN Code</button>
        <button class="tab tab-child" data-tab="account" data-sub-tab="email-prefs">Email Preferences</button>
        <button class="tab tab-child" data-tab="account" data-sub-tab="account-actions">Account Actions</button>
      </div>
      <button class="tab" data-tab="subscription" style="display:none;">Subscription</button>
      <!-- Voting tab removed - voting is done through the mobile app -->
      <!-- Vault Services - simplified to single tab (no sub-navigation) -->
      <button class="tab" id="vaultParent" data-tab="deploy-vault" style="display:none;">Vault Services</button>
      <!-- Hidden sub-tabs for backwards compatibility -->
      <div class="tab-children" id="vaultChildren" style="display:none;">
        <button class="tab tab-child" data-tab="deploy-vault" data-sub-tab="deploy">My Vault</button>
        <button class="tab tab-child" data-tab="deploy-vault" data-sub-tab="byov" style="display:none;">Bring Your Own Vault</button>
        <button class="tab tab-child" data-tab="deploy-vault" data-sub-tab="credential-backup" style="display:none;">Credential Backup</button>
      </div>
    </div>
  </div>
  <button class="sidebar-toggle" id="sidebarToggle">&lt;</button>

  <div class="wrap">

<div id="getting-started" class="tab-content card active">
  <h3>Getting Started with VettID</h3>
  <p style="margin-bottom:16px;">Follow these steps to set up your VettID account and start using our secure services.</p>

  <!-- Overall Progress Bar -->
  <div id="overallProgress" style="margin-bottom:24px;padding:16px;background:var(--bg-card);border-radius:8px;border:2px solid var(--border);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
      <span style="font-weight:600;font-size:0.9rem;">Overall Progress</span>
      <span id="progressText" style="font-weight:600;font-size:0.9rem;color:var(--accent);">Loading...</span>
    </div>
    <div style="background:var(--bg-card);border-radius:8px;height:12px;overflow:hidden;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3);">
      <div id="progressBar" style="background:linear-gradient(90deg,var(--accent) 0%,#ffc125 100%);height:100%;width:0%;transition:width 0.5s ease;box-shadow:0 0 10px rgba(255,193,37,0.5);"></div>
    </div>
  </div>

  <div id="gettingStartedSteps" style="display:flex;flex-direction:column;gap:16px;margin-bottom:24px;">
    <!-- Loading indicator shown initially -->
    <div style="padding:40px;background:var(--bg-card);border-radius:8px;border:2px solid var(--border);text-align:center;">
      <div style="display:inline-block;width:40px;height:40px;border:3px solid rgba(255,193,37,0.1);border-top:3px solid var(--accent);border-radius:50%;animation:spin 1s linear infinite;"></div>
      <p style="margin-top:16px;color:var(--gray);font-size:1rem;">Loading your getting started steps...</p>
    </div>
  </div>

  <button id="gotItBtn" class="btn" style="background:linear-gradient(135deg,#4caf50 0%,#2e7d32 100%);color:#fff;padding:14px 24px;font-size:1rem;font-weight:600;">Got It!</button>
</div>

<div id="account" class="tab-content">
  <!-- Profile Sub-tab -->
  <div id="account-profile" class="sub-tab-content active">
    <div class="card">
      <h3>Your Profile</h3>
      <div>
        <p><strong>First name</strong><br/><span id="firstName">â€”</span></p>
        <p><strong>Last name</strong><br/><span id="lastName">â€”</span></p>
        <p><strong>Email</strong><br/><span id="email">â€”</span></p>
        <p><strong>User GUID</strong><br/><code id="userGuid">â€”</code></p>
      </div>

      <hr style="margin:20px 0;border:none;border-top:1px solid var(--border)" />

      <h4 style="margin:0 0 12px;">Membership Status</h4>
      <div id="membershipStatusBox" style="padding:12px;background:var(--bg-card);border-radius:4px;margin-bottom:16px;">
        <p style="margin:0;"><strong>Status:</strong> <span id="membershipStatus">Loading...</span></p>
        <p id="membershipDetails" style="margin:8px 0 0;"></p>
      </div>

      <h4 style="margin:0 0 12px;">Subscription Status</h4>
      <div id="profileSubscriptionStatus" style="padding:12px;background:var(--bg-card);border-radius:4px;">
        <p style="margin:0;">Loading...</p>
      </div>
    </div>
  </div>

  <!-- Membership Sub-tab -->
  <div id="account-membership" class="sub-tab-content">
    <div class="card" id="membershipCard">
      <h3>Membership</h3>
      <p style="margin-bottom:16px;">VettID is a cooperative dedicated to our member's online security and privacy. In order to become a member you must read and accept our membership terms. Members must have an active trial or subscription in order to use the service. Members with active subscriptions have voting rights in the cooperative. You may cancel a subscription and maintain your membership without service access or voting rights. If you wish to cancel your membership you must cancel the account you registered. Upon cancellation your account data will be held for 7 days and may be recovered by contacting <a href="mailto:restore@vettid.dev" style="color:var(--accent);text-decoration:underline;">restore@vettid.dev</a>. Cancelled accounts will be permanently deleted 7 days after cancellation.</p>

      <!-- Membership Terms Section (shown for non-members) -->
      <div id="membershipTermsSection" style="display:none;">
        <hr style="margin:20px 0;border:none;border-top:1px solid var(--border)" />
        <h4 style="margin:0 0 12px;">Membership Terms of Service</h4>
        <p class="muted" style="font-size:0.9rem;margin-bottom:16px;">
          Please review and accept the membership terms to become a full member. You'll be granted immediate access after accepting.
        </p>

        <div id="termsTextBox" style="padding:16px;border-radius:4px;border:1px solid var(--border);max-height:400px;overflow-y:auto;margin-bottom:16px;">
          <p class="muted">Loading terms...</p>
        </div>

        <div style="margin-bottom:16px;">
          <a id="termsDownloadLink" href="#" target="_blank" class="btn" style="display:inline-block;">Download Membership Terms</a>
        </div>

        <div style="margin-bottom:16px;padding:12px;background:var(--bg-card);border-radius:4px;border:1px solid var(--border);">
          <label style="display:flex;align-items:start;cursor:pointer;">
            <input type="checkbox" id="acceptTermsCheckbox" style="margin-right:12px;margin-top:4px;">
            <span>I have read and agree to the VettID Membership Terms of Service</span>
          </label>
        </div>

        <button id="requestMembershipBtn" class="btn btn-primary" style="width:100%;opacity:0.5;" disabled data-action="requestMembership">
          Accept Terms and Request Membership
        </button>
        <p id="requestMembershipMsg" style="margin-top:12px;font-size:0.9rem;"></p>
      </div>

      <!-- Member Details Section (shown for approved members) -->
      <div id="memberInfoSection" style="display:none;">
        <hr style="margin:20px 0;border:none;border-top:1px solid var(--border)" />
        <h4 style="margin:0 0 12px;">Membership Details</h4>
        <div style="padding:16px;background:var(--bg-card);border-radius:4px;border:1px solid var(--border);margin-bottom:16px;">
          <p id="memberDetailsText"></p>
        </div>
        <div>
          <a id="memberTermsDownloadLink" href="#" target="_blank" class="btn" style="display:inline-block;">Download Membership Terms</a>
        </div>
      </div>
    </div>
  </div>

  <!-- PIN Code Sub-tab -->
  <div id="account-pin-code" class="sub-tab-content">
    <div class="card" id="pinCodeCard">
      <h3>PIN Code</h3>
      <p class="muted" style="font-size:0.9rem;margin-bottom:16px;">
        Add an extra layer of security to your account by requiring a 4-6 digit PIN code when logging in with magic links.
      </p>

      <div id="pinStatusBox" style="padding:16px;background:var(--bg-card);border-radius:4px;margin-bottom:16px;">
        <p><strong>Status:</strong> <span id="pinStatus">Loading...</span></p>
        <p id="pinUpdatedAt" style="margin-top:8px;"></p>
      </div>

      <div id="pinActions" style="display:flex;gap:12px;flex-wrap:wrap;">
        <button class="btn" id="enablePinBtn" style="display:none;background:linear-gradient(135deg,#4caf50 0%,#2e7d32 100%);color:#fff;">Enable PIN</button>
        <button class="btn" id="updatePinBtn" style="display:none;">Change PIN</button>
        <button class="btn" id="disablePinBtn" style="display:none;background:linear-gradient(135deg,#d32f2f 0%,#a00 100%);color:#fff;">Disable PIN</button>
      </div>
    </div>
  </div>

  <!-- Email Preferences Sub-tab -->
  <div id="account-email-prefs" class="sub-tab-content">
    <div class="card">
      <h3>Email Preferences</h3>
      <p class="muted" style="font-size:0.9rem;margin-bottom:16px;">
        Control whether you receive system emails such as account notifications, security alerts, and service updates.
      </p>

      <div id="emailPrefsBox" style="padding:16px;background:var(--bg-card);border-radius:4px;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <strong style="display:block;margin-bottom:4px;">System Emails</strong>
            <span id="emailPrefsStatus" class="muted" style="font-size:0.85rem;">Loading...</span>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="systemEmailsToggle" disabled>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Actions Sub-tab -->
  <div id="account-account-actions" class="sub-tab-content">
    <div class="card">
      <h3>Account Actions</h3>
      <button class="btn" id="cancelAccountBtn" style="background:linear-gradient(135deg,#d32f2f 0%,#a00 100%);color:#fff;box-shadow:0 4px 12px rgba(211,47,47,0.3);">Cancel account</button>
      <p class="muted" style="font-size:0.85rem;margin-top:8px;">Canceling your account will disable your access. Your data will be held for 7 days before being permanently deleted. If you would like to restore your account or immediately delete your data please contact <a href="mailto:restore@vettid.dev" style="color:#4fc3f7;text-decoration:none;">restore@vettid.dev</a>.</p>
    </div>
  </div>
</div>

<!-- PIN Modals -->
<div id="enablePinModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:1000;align-items:center;justify-content:center;">
  <div style="background:var(--bg-card);padding:32px;border-radius:8px;max-width:400px;width:90%;border:2px solid var(--accent);">
    <h3 style="margin-top:0;">Enable PIN Code</h3>
    <p class="muted" style="margin-bottom:20px;">Create a 4-6 digit PIN code for additional security.</p>
    <div>
      <label for="newPinInput" style="display:block;margin-bottom:8px;font-weight:600;">Enter PIN (4-6 digits)</label>
      <input type="password" id="newPinInput" maxlength="6" pattern="[0-9]*" inputmode="numeric"
             style="width:100%;padding:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:1.1rem;letter-spacing:0.2em;text-align:center;"
             placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
      <label for="confirmPinInput" style="display:block;margin:16px 0 8px;font-weight:600;">Confirm PIN</label>
      <input type="password" id="confirmPinInput" maxlength="6" pattern="[0-9]*" inputmode="numeric"
             style="width:100%;padding:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:1.1rem;letter-spacing:0.2em;text-align:center;"
             placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
      <div id="pinMatchIndicator" style="display:none;margin-top:8px;padding:8px 12px;border-radius:4px;font-size:0.9rem;display:flex;align-items:center;gap:8px;"></div>
    </div>
    <div style="display:flex;gap:12px;margin-top:24px;">
      <button class="btn" id="confirmEnablePinBtn" style="flex:1;background:linear-gradient(135deg,#4caf50 0%,#2e7d32 100%);color:#fff;">Enable</button>
      <button class="btn" id="cancelEnablePinBtn" style="flex:1;">Cancel</button>
    </div>
  </div>
</div>

<div id="updatePinModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:1000;align-items:center;justify-content:center;">
  <div style="background:var(--bg-card);padding:32px;border-radius:8px;max-width:400px;width:90%;border:2px solid var(--accent);">
    <h3 style="margin-top:0;">Change PIN Code</h3>
    <p class="muted" style="margin-bottom:20px;">Enter your current PIN and new 4-6 digit PIN code.</p>
    <div>
      <label for="currentPinInput" style="display:block;margin-bottom:8px;font-weight:600;">Current PIN</label>
      <input type="password" id="currentPinInput" maxlength="6" pattern="[0-9]*" inputmode="numeric"
             style="width:100%;padding:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:1.1rem;letter-spacing:0.2em;text-align:center;"
             placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
      <label for="updatePinInput" style="display:block;margin:16px 0 8px;font-weight:600;">New PIN (4-6 digits)</label>
      <input type="password" id="updatePinInput" maxlength="6" pattern="[0-9]*" inputmode="numeric"
             style="width:100%;padding:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:1.1rem;letter-spacing:0.2em;text-align:center;"
             placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
      <label for="confirmUpdatePinInput" style="display:block;margin:16px 0 8px;font-weight:600;">Confirm New PIN</label>
      <input type="password" id="confirmUpdatePinInput" maxlength="6" pattern="[0-9]*" inputmode="numeric"
             style="width:100%;padding:12px;background:var(--bg-card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-size:1.1rem;letter-spacing:0.2em;text-align:center;"
             placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
    </div>
    <div style="display:flex;gap:12px;margin-top:24px;">
      <button class="btn" id="confirmUpdatePinBtn" style="flex:1;">Update PIN</button>
      <button class="btn" id="cancelUpdatePinBtn" style="flex:1;">Cancel</button>
    </div>
  </div>
</div>

<div id="subscription" class="tab-content">
  <div style="display:flex;flex-direction:column;gap:20px;max-width:800px;">
    <!-- Current Subscription Card -->
    <div class="card">
      <h3>Current Subscription</h3>
      <div id="currentSubscriptionDetails">
        <p class="muted">Loading subscription status...</p>
      </div>
      <p id="subscriptionMessage" style="display:none;margin-top:16px;padding:16px;border-radius:4px;"></p>
    </div>

    <!-- Change Subscription Card -->
    <div class="card">
      <h3>Change Subscription</h3>
      <p class="muted" style="font-size:0.9rem;margin-bottom:16px;">Select a subscription plan to activate or change your current subscription.</p>

      <div id="subscriptionOptionsSection">
        <p class="muted" style="text-align:center;">Loading subscription options...</p>
      </div>
    </div>
  </div>
</div>

<script src="/account/js/utils.js"></script>

<div id="deploy-vault" class="tab-content">
  <!-- Deploy a Vault Sub-tab -->
  <div id="vault-deploy" class="sub-tab-content active">
    <div class="card" id="vaultStatusCard">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="margin:0;">Vault Status</h3>
        <button data-action="loadVaultStatus" class="btn" style="padding:6px 12px;font-size:0.85rem;background:#333;" title="Refresh">â†» Refresh</button>
      </div>
      <p class="muted" style="margin-bottom:20px;font-size:0.95rem;">Deploy and configure your secure vault. Have your mobile phone available.</p>

      <!-- Vault Status Content - Dynamic -->
      <div id="vaultStatusContent">
        <div style="padding:24px;background:#050505;border-radius:4px;border:1px solid var(--border);text-align:center;">
          <div class="skeleton" style="height:24px;width:120px;margin:0 auto 12px auto;border-radius:4px;"></div>
          <div class="skeleton" style="height:16px;width:200px;margin:0 auto;border-radius:4px;"></div>
        </div>
      </div>
    </div>


    <!-- Provisioning Card - Shown during provisioning -->
    <div class="card" id="vaultProvisioningCard" style="display:none;">
      <h3>Provisioning Your Vault</h3>
      <div style="margin-top:20px;">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
          <div style="width:24px;height:24px;border:3px solid var(--accent);border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;"></div>
          <span id="provisioningStatus" style="color:var(--text);">Launching instance...</span>
        </div>
        <div style="background:#050505;border-radius:4px;padding:16px;border:1px solid var(--border);">
          <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <span class="muted">Progress</span>
            <span id="provisioningProgress" style="color:var(--accent);">0%</span>
          </div>
          <div style="height:8px;background:#222;border-radius:4px;overflow:hidden;">
            <div id="provisioningProgressBar" style="height:100%;background:linear-gradient(90deg,var(--accent),#f59e0b);width:0%;transition:width 0.5s ease;"></div>
          </div>
        </div>
        <p class="muted" style="margin-top:12px;font-size:0.85rem;">This usually takes 2-3 minutes. You can leave this page and come back.</p>
      </div>
    </div>

    <!-- Vault Deletion Card - Shown when vault is active -->
    <div class="card" id="vaultDeletionCard" style="display:none;margin-top:20px;border-color:#f44336;">
      <h3 style="margin:0 0 16px 0;color:#f44336;">Danger Zone</h3>

      <!-- Normal state: No deletion pending -->
      <div id="deletionNormalState">
        <p class="muted" style="margin-bottom:16px;font-size:0.95rem;">
          Permanently delete your vault and all associated data. This action cannot be undone.
        </p>
        <button data-action="requestVaultDeletion" class="btn" style="padding:10px 20px;background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);font-weight:600;">
          Request Vault Deletion
        </button>
      </div>

      <!-- Pending state: Deletion requested, waiting for 24hr -->
      <div id="deletionPendingState" style="display:none;">
        <div style="padding:20px;background:rgba(244,67,54,0.1);border-radius:8px;border:1px solid #f44336;">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
            <div style="width:40px;height:40px;background:#f44336;border-radius:50%;display:flex;align-items:center;justify-content:center;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
              </svg>
            </div>
            <div>
              <p style="margin:0;color:#f44336;font-weight:600;">Deletion Pending</p>
              <p id="deletionTimeRemaining" style="margin:4px 0 0 0;color:var(--gray);font-size:0.9rem;">Time remaining: --</p>
            </div>
          </div>
          <p style="margin:0 0 16px 0;color:var(--gray);font-size:0.9rem;">
            Your vault deletion has been scheduled. You can cancel this request at any time before confirmation.
          </p>
          <button data-action="cancelVaultDeletion" class="btn" style="padding:10px 20px;background:#333;font-weight:600;">
            Cancel Deletion Request
          </button>
        </div>
      </div>

      <!-- Ready state: 24hr passed, can confirm deletion -->
      <div id="deletionReadyState" style="display:none;">
        <div style="padding:20px;background:rgba(244,67,54,0.2);border-radius:8px;border:2px solid #f44336;">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
            <div style="width:40px;height:40px;background:#f44336;border-radius:50%;display:flex;align-items:center;justify-content:center;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
              </svg>
            </div>
            <div>
              <p style="margin:0;color:#f44336;font-weight:600;">Ready to Delete</p>
              <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.9rem;">The 24-hour waiting period has passed.</p>
            </div>
          </div>
          <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:6px;margin-bottom:16px;">
            <p style="margin:0;color:#f44336;font-weight:600;font-size:0.9rem;">âš ï¸ WARNING: This action is IRREVERSIBLE</p>
            <ul style="margin:8px 0 0 0;padding-left:20px;color:var(--gray);font-size:0.85rem;line-height:1.6;">
              <li>All vault data will be permanently deleted</li>
              <li>Your credentials will no longer be accessible</li>
              <li>You will need to re-enroll to use VettID again</li>
            </ul>
          </div>
          <div style="display:flex;gap:12px;flex-wrap:wrap;">
            <button data-action="confirmVaultDeletion" class="btn" style="padding:10px 20px;background:linear-gradient(135deg,#ef4444 0%,#b91c1c 100%);font-weight:600;">
              Confirm Permanent Deletion
            </button>
            <button data-action="cancelVaultDeletion" class="btn" style="padding:10px 20px;background:#333;font-weight:600;">
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Credential Backup Card (integrated into vault view) -->
    <div class="card" id="credentialBackupCard" style="margin-top:20px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="margin:0;">Credential Backup</h3>
        <button data-action="loadCredentialBackupStatus" class="btn" style="padding:6px 12px;font-size:0.85rem;background:#333;" title="Refresh">â†» Refresh</button>
      </div>

      <!-- Backup Status (read-only - settings managed in mobile app) -->
      <div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:#050505;border-radius:8px;border:1px solid var(--border);margin-bottom:16px;">
        <div>
          <p style="margin:0;color:var(--text);font-weight:600;">Automatic Backups</p>
          <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.85rem;">Encrypted credentials backed up automatically</p>
        </div>
        <div id="backupStatusBadgeInline" style="padding:6px 12px;background:#4caf50;color:#000;border-radius:16px;font-size:0.75rem;font-weight:700;">
          ENABLED
        </div>
      </div>
      <p style="margin:0 0 16px 0;color:var(--gray);font-size:0.8rem;font-style:italic;">
        â„¹ï¸ Backup settings can be managed in the VettID mobile app.
      </p>

      <!-- Backup Status Grid -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
        <div style="padding:12px;background:#050505;border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">Status</p>
          <p id="backupStatusValueInline" style="margin:6px 0 0 0;color:var(--text);font-weight:600;">--</p>
        </div>
        <div style="padding:12px;background:#050505;border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">Last Backup</p>
          <p id="lastBackupValueInline" style="margin:6px 0 0 0;color:var(--text);font-weight:600;">--</p>
        </div>
      </div>

      <!-- Recovery Options -->
      <div style="padding:16px;background:#050505;border-radius:8px;border:1px solid var(--border);">
        <p style="margin:0 0 12px 0;color:var(--gray);font-size:0.85rem;">Need to restore your credentials?</p>
        <div style="display:flex;gap:12px;flex-wrap:wrap;">
          <button data-action="requestTransfer" class="btn" style="padding:8px 16px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);font-size:0.85rem;">
            Transfer to New Device
          </button>
          <button data-action="requestRecovery" class="btn" style="padding:8px 16px;background:linear-gradient(135deg,#f59e0b 0%,#d97706 100%);color:#000;font-size:0.85rem;">
            Recover Lost Credentials
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bring Your Own Vault Sub-tab (hidden) -->
  <div id="vault-byov" class="sub-tab-content">
    <!-- BYOV Status Card -->
    <div class="card" id="byovStatusCard">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="margin:0;">Bring Your Own Vault</h3>
        <button data-action="loadByovStatus" class="btn" style="padding:6px 12px;font-size:0.85rem;background:#333;" title="Refresh">â†» Refresh</button>
      </div>
      <p class="muted" style="margin-bottom:20px;font-size:0.95rem;">
        Connect your self-hosted vault instance to VettID. Your vault must be accessible via HTTPS and respond to health checks.
      </p>

      <div id="byovStatusContent">
        <!-- Status will be loaded here -->
        <div style="padding:24px;background:#050505;border-radius:4px;border:1px solid var(--border);text-align:center;">
          <div class="skeleton" style="height:24px;width:200px;margin:0 auto;border-radius:4px;"></div>
        </div>
      </div>
    </div>

    <!-- Register BYOV Card (shown when no vault registered) -->
    <div class="card" style="margin-top:20px;display:none;" id="byovRegisterCard">
      <h3 style="margin:0 0 16px 0;">Register Your Vault</h3>
      <p class="muted" style="margin-bottom:20px;font-size:0.95rem;">
        Enter your vault's URL to connect it to VettID. We'll verify connectivity before completing registration.
      </p>

      <div style="display:grid;gap:16px;">
        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Vault Name</label>
          <input type="text" id="byovVaultName" placeholder="My Home Vault"
            style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;" />
          <p style="margin:8px 0 0 0;color:var(--gray);font-size:0.8rem;">A friendly name to identify this vault.</p>
        </div>

        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Vault URL</label>
          <input type="url" id="byovVaultUrl" placeholder="https://vault.example.com"
            style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;" />
          <p style="margin:8px 0 0 0;color:var(--gray);font-size:0.8rem;">HTTPS URL to your vault instance (e.g., Vaultwarden, Bitwarden).</p>
        </div>

        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">API Key (Optional)</label>
          <input type="password" id="byovApiKey" placeholder="Enter API key if required"
            style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;" />
          <p style="margin:8px 0 0 0;color:var(--gray);font-size:0.8rem;">If your vault requires an API key for access.</p>
        </div>

        <div style="display:flex;align-items:center;gap:12px;">
          <input type="checkbox" id="byovVerifySsl" checked style="width:20px;height:20px;cursor:pointer;" />
          <label for="byovVerifySsl" style="color:var(--text);cursor:pointer;">Verify SSL Certificate</label>
        </div>

        <div id="byovRegisterError" style="display:none;padding:12px;background:rgba(244,67,54,0.1);border:1px solid #f44336;border-radius:6px;color:#f44336;font-size:0.9rem;">
        </div>

        <button data-action="registerByovVault" id="registerByovBtn" class="btn"
          style="padding:12px 24px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);font-weight:600;width:fit-content;">
          Register Vault
        </button>
      </div>
    </div>

    <!-- Connected Vault Card (shown when vault is registered) -->
    <div class="card" style="margin-top:20px;display:none;" id="byovConnectedCard">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;">
        <div>
          <h3 style="margin:0;" id="byovConnectedName">My Vault</h3>
          <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.85rem;" id="byovConnectedUrl">https://vault.example.com</p>
        </div>
        <div id="byovHealthBadge" style="padding:6px 12px;border-radius:16px;font-size:0.75rem;font-weight:600;text-transform:uppercase;">
          Unknown
        </div>
      </div>

      <!-- Vault Info Grid -->
      <div id="byovInfoGrid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px;">
        <div style="padding:12px;background:var(--bg-card);border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">Status</p>
          <p style="margin:4px 0 0 0;color:var(--text);font-weight:600;" id="byovInfoStatus">-</p>
        </div>
        <div style="padding:12px;background:var(--bg-card);border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">Last Check</p>
          <p style="margin:4px 0 0 0;color:var(--text);font-weight:600;" id="byovInfoLastCheck">-</p>
        </div>
        <div style="padding:12px;background:var(--bg-card);border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">Registered</p>
          <p style="margin:4px 0 0 0;color:var(--text);font-weight:600;" id="byovInfoCreated">-</p>
        </div>
        <div style="padding:12px;background:var(--bg-card);border-radius:6px;border:1px solid var(--border);">
          <p style="margin:0;color:var(--gray);font-size:0.75rem;text-transform:uppercase;">API Key</p>
          <p style="margin:4px 0 0 0;color:var(--text);font-weight:600;" id="byovInfoApiKey">-</p>
        </div>
      </div>

      <!-- Health Message -->
      <div id="byovHealthMessage" style="display:none;padding:12px;border-radius:6px;margin-bottom:16px;font-size:0.9rem;">
      </div>

      <!-- Action Buttons -->
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <button data-action="verifyByovVault" id="verifyByovBtn" class="btn"
          style="padding:10px 20px;background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);font-weight:600;">
          Verify Connection
        </button>
        <button data-action="showByovSettingsModal" class="btn" style="padding:10px 20px;background:#333;">
          Settings
        </button>
        <button data-action="confirmDeleteByovVault" class="btn" style="padding:10px 20px;background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);">
          Remove Vault
        </button>
      </div>
    </div>

    <!-- Requirements Card -->
    <div class="card" style="margin-top:20px;">
      <h3 style="margin:0 0 16px 0;">Requirements</h3>
      <div style="display:grid;gap:12px;">
        <div style="display:flex;gap:12px;align-items:flex-start;">
          <div style="width:24px;height:24px;background:#10b981;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
          <div>
            <p style="margin:0;color:var(--text);font-weight:600;">HTTPS Required</p>
            <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.85rem;">Your vault must be accessible via HTTPS with a valid SSL certificate.</p>
          </div>
        </div>
        <div style="display:flex;gap:12px;align-items:flex-start;">
          <div style="width:24px;height:24px;background:#10b981;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
          <div>
            <p style="margin:0;color:var(--text);font-weight:600;">Health Endpoint</p>
            <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.85rem;">Vault must respond to GET /api/health with a 200 status.</p>
          </div>
        </div>
        <div style="display:flex;gap:12px;align-items:flex-start;">
          <div style="width:24px;height:24px;background:#10b981;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </div>
          <div>
            <p style="margin:0;color:var(--text);font-weight:600;">Public Accessibility</p>
            <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.85rem;">Vault must be accessible from the internet (not localhost).</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Credential Backup Sub-tab -->
  <div id="vault-credential-backup" class="sub-tab-content">
    <!-- Backup Settings Card (read-only - settings managed in mobile app) -->
    <div class="card" id="backupSettingsCard">
      <h3 style="margin:0 0 16px 0;">Backup Settings</h3>
      <div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:#050505;border-radius:8px;border:1px solid var(--border);">
        <div>
          <p style="margin:0;color:var(--text);font-weight:600;">Automatic Credential Backups</p>
          <p style="margin:4px 0 0 0;color:var(--gray);font-size:0.9rem;">Your encrypted credentials are backed up automatically for security.</p>
        </div>
        <div id="backupStatusBadge" style="padding:6px 12px;background:#4caf50;color:#000;border-radius:16px;font-size:0.75rem;font-weight:700;">
          ENABLED
        </div>
      </div>
      <div style="margin-top:16px;padding:16px;background:rgba(var(--accent-rgb),0.1);border:1px solid var(--accent);border-radius:8px;">
        <p style="margin:0;color:var(--text);font-size:0.9rem;">
          <strong>â„¹ï¸ Mobile App Control</strong><br>
          <span style="color:var(--gray);">Automatic backups are enabled by default to protect your credentials. To disable automatic backups, use the Settings menu in your VettID mobile app.</span>
        </p>
      </div>
    </div>

    <!-- Backup Status Card -->
    <div class="card" style="margin-top:20px;" id="credentialBackupStatusCard">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="margin:0;">Backup Status</h3>
        <button data-action="loadCredentialBackupStatus" class="btn" style="padding:6px 12px;font-size:0.85rem;background:#333;" title="Refresh">â†» Refresh</button>
      </div>
      <div id="credentialBackupStatusContent">
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;">
          <div style="padding:16px;background:#050505;border-radius:8px;border:1px solid var(--border);">
            <p style="margin:0;color:var(--gray);font-size:0.85rem;">Status</p>
            <p id="backupStatusValue" style="margin:8px 0 0 0;color:var(--text);font-weight:600;font-size:1.1rem;">--</p>
          </div>
          <div style="padding:16px;background:#050505;border-radius:8px;border:1px solid var(--border);">
            <p style="margin:0;color:var(--gray);font-size:0.85rem;">Last Backup</p>
            <p id="lastBackupValue" style="margin:8px 0 0 0;color:var(--text);font-weight:600;font-size:1.1rem;">--</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Credential Restore Card -->
    <div class="card" style="margin-top:20px;" id="credentialRestoreCard">
      <h3 style="margin:0 0 8px 0;">Restore Credentials</h3>
      <p class="muted" style="margin-bottom:20px;font-size:0.95rem;">
        Transfer your credentials to a new device or recover them if your device is lost.
      </p>

      <!-- Restore Status (shown when restore is pending) -->
      <div id="restoreStatusSection" style="display:none;margin-bottom:20px;">
        <div id="restoreStatusContent" style="padding:20px;background:#050505;border-radius:8px;border:2px solid var(--accent);">
          <!-- Status will be loaded dynamically -->
        </div>
      </div>

      <!-- Restore Options (shown when no restore is pending) -->
      <div id="restoreOptionsSection" style="display:grid;gap:16px;">
        <!-- Transfer to New Device -->
        <div style="padding:20px;background:#050505;border-radius:8px;border:1px solid var(--border);">
          <div style="display:flex;align-items:start;gap:16px;">
            <div style="width:48px;height:48px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                <line x1="12" y1="18" x2="12" y2="18"></line>
              </svg>
            </div>
            <div style="flex:1;">
              <h4 style="margin:0 0 8px 0;color:var(--text);">Transfer to New Device</h4>
              <p style="margin:0 0 16px 0;color:var(--gray);font-size:0.9rem;">
                Have your old device? We'll send a notification for instant approval.
              </p>
              <button data-action="requestTransfer" class="btn" style="padding:10px 20px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);font-weight:600;">
                Request Transfer
              </button>
            </div>
          </div>
        </div>

        <!-- Recover Lost Credentials -->
        <div style="padding:20px;background:#050505;border-radius:8px;border:1px solid var(--border);">
          <div style="display:flex;align-items:start;gap:16px;">
            <div style="width:48px;height:48px;background:linear-gradient(135deg,#f59e0b 0%,#d97706 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              </svg>
            </div>
            <div style="flex:1;">
              <h4 style="margin:0 0 8px 0;color:var(--text);">Recover Lost Credentials</h4>
              <p style="margin:0 0 16px 0;color:var(--gray);font-size:0.9rem;">
                Lost your device? A 24-hour security delay protects your account.
              </p>
              <button data-action="requestRecovery" class="btn" style="padding:10px 20px;background:linear-gradient(135deg,#f59e0b 0%,#d97706 100%);color:#000;font-weight:600;">
                Start Recovery
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Confirm Recovery Section (shown when ready) -->
      <div id="confirmRecoverySection" style="display:none;margin-top:20px;">
        <div style="padding:20px;background:linear-gradient(135deg,rgba(16,185,129,0.1) 0%,rgba(5,150,105,0.05) 100%);border:2px solid #10b981;border-radius:8px;">
          <h4 style="margin:0 0 16px 0;color:#10b981;">Recovery Ready</h4>
          <p style="margin:0 0 16px 0;color:var(--gray);font-size:0.9rem;">
            Enter your recovery phrase to complete the restoration.
          </p>
          <div style="display:grid;gap:16px;">
            <div>
              <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Recovery Phrase</label>
              <textarea id="credRecoveryPhrase" placeholder="Enter your recovery phrase" rows="3"
                style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;resize:vertical;font-family:monospace;"></textarea>
            </div>
            <div id="credRecoveryError" style="display:none;padding:12px;background:rgba(244,67,54,0.1);border:1px solid #f44336;border-radius:6px;color:#f44336;font-size:0.9rem;"></div>
            <button data-action="confirmRecovery" id="confirmRecoveryBtn" class="btn"
              style="padding:12px 24px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);font-weight:600;width:fit-content;">
              Complete Recovery
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Voting tab removed - voting is done through the mobile app -->

  </div><!-- end .wrap -->
</div><!-- end .main-container -->

<!-- Proposal Results Modal removed - voting is done through the mobile app -->

<!-- PIN Disable Confirmation Modal -->
<div id="pinDisableModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;backdrop-filter:blur(4px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid #ffc125;box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:500px;width:90%;">
    <div style="padding:24px;border-bottom:2px solid #222;">
      <h3 style="margin:0;color:#ffc125;">Disable PIN Authentication</h3>
    </div>
    <div style="padding:24px;">
      <p style="margin:0 0 20px 0;color:var(--gray);line-height:1.6;">Enter your current PIN to confirm disabling PIN authentication. You will only need your magic link to sign in after this.</p>
      <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Current PIN</label>
      <input type="password" id="pinDisableInput" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="Enter 4-6 digit PIN" style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;" />
      <p id="pinDisableError" style="margin:12px 0 0 0;color:#f44336;font-size:0.9rem;display:none;"></p>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;gap:12px;justify-content:flex-end;">
      <button data-action="closePinDisableModal" class="btn" style="padding:10px 24px;background:#333;">Cancel</button>
      <button data-action="submitPinDisable" class="btn" style="padding:10px 24px;background:linear-gradient(135deg,#f44336 0%,#c62828 100%);">Disable PIN</button>
    </div>
  </div>
</div>

<!-- PIN Verification on Login Modal -->
<div id="verifyPinLoginModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.95);z-index:10000;backdrop-filter:blur(8px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid #ffc125;box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:420px;width:90%;">
    <div style="padding:24px;border-bottom:2px solid #222;text-align:center;">
      <div style="width:64px;height:64px;margin:0 auto 16px;background:linear-gradient(135deg,#ffc125 0%,#ff9800 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
      </div>
      <h3 style="margin:0;color:#ffc125;font-size:1.3rem;">PIN Verification Required</h3>
    </div>
    <div style="padding:24px;">
      <p style="margin:0 0 20px 0;color:var(--gray);line-height:1.6;text-align:center;">Enter your PIN to access your account.</p>
      <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">PIN Code</label>
      <input type="password" id="verifyPinLoginInput" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="Enter 4-6 digit PIN" style="width:100%;padding:14px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1.1rem;text-align:center;letter-spacing:0.3em;" />
      <p id="verifyPinLoginError" style="margin:12px 0 0 0;color:#f44336;font-size:0.9rem;display:none;text-align:center;"></p>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;gap:12px;justify-content:center;">
      <button data-action="submitPinVerification" id="verifyPinLoginBtn" class="btn" style="padding:12px 48px;background:linear-gradient(135deg,#4caf50 0%,#2e7d32 100%);font-weight:600;">Verify</button>
    </div>
    <div style="padding:0 24px 16px;text-align:center;">
      <a href="#" data-action="signOut" style="color:var(--gray);font-size:0.85rem;text-decoration:none;">Sign out and use a different account</a>
    </div>
  </div>
</div>

<!-- Generic Confirm Modal -->
<div id="confirmModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;backdrop-filter:blur(4px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid #ffc125;box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:500px;width:90%;">
    <div style="padding:24px;border-bottom:2px solid #222;">
      <h3 id="confirmModalTitle" style="margin:0;color:#ffc125;">Confirm Action</h3>
    </div>
    <div style="padding:24px;">
      <p id="confirmModalMessage" style="margin:0;color:var(--gray);line-height:1.6;"></p>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;gap:12px;justify-content:flex-end;flex-wrap:wrap;">
      <button id="confirmModalCancel" class="btn" style="padding:10px 24px;background:#333;">Cancel</button>
      <button id="confirmModalConfirm" class="btn" style="padding:10px 24px;background:linear-gradient(135deg,#f44336 0%,#c62828 100%);">Confirm</button>
    </div>
  </div>
</div>

<!-- Alert Modal (for success/error messages) -->
<div id="alertModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;backdrop-filter:blur(4px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid var(--accent);box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:450px;width:90%;">
    <div style="padding:24px;border-bottom:2px solid #222;">
      <h3 id="alertModalTitle" style="margin:0;color:var(--accent);display:flex;align-items:center;gap:10px;"></h3>
    </div>
    <div style="padding:24px;">
      <p id="alertModalMessage" style="margin:0;color:var(--gray);line-height:1.6;"></p>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;justify-content:flex-end;">
      <button id="alertModalOk" class="btn" style="padding:10px 32px;background:linear-gradient(135deg,var(--accent) 0%,#ffc125 100%);color:#000;">OK</button>
    </div>
  </div>
</div>

<!-- Membership Confirmation Modal -->
<div id="membershipConfirmModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;backdrop-filter:blur(4px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid var(--accent);box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:550px;width:90%;">
    <div style="padding:24px;border-bottom:2px solid #222;">
      <h3 style="margin:0;color:var(--accent);display:flex;align-items:center;gap:12px;">
        <span style="font-size:1.5rem;">âœ“</span>
        Confirm Membership
      </h3>
    </div>
    <div style="padding:24px;">
      <p style="margin:0;color:var(--text);line-height:1.6;font-size:1rem;">Accept membership terms and become a full member?</p>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;gap:12px;justify-content:flex-end;">
      <button data-action="closeMembershipConfirmModal" class="btn" style="padding:12px 28px;background:#333;font-weight:600;">Cancel</button>
      <button data-action="confirmMembership" class="btn" style="padding:12px 28px;background:linear-gradient(135deg,#ffd940 0%,#ffc125 100%);color:#000;font-weight:700;box-shadow:0 4px 14px rgba(255,217,64,0.4);">Accept & Continue</button>
    </div>
  </div>
</div>

<!-- BYOV Settings Modal -->
<div id="byovSettingsModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;backdrop-filter:blur(4px);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);border-radius:12px;border:2px solid var(--accent);box-shadow:0 10px 40px rgba(255,193,37,0.3);max-width:550px;width:90%;max-height:90vh;overflow-y:auto;">
    <div style="padding:24px;border-bottom:2px solid #222;display:flex;justify-content:space-between;align-items:center;">
      <h3 style="margin:0;color:var(--accent);display:flex;align-items:center;gap:12px;">
        <span style="font-size:1.5rem;">âš™ï¸</span>
        Vault Settings
      </h3>
      <button data-action="closeByovSettingsModal" style="background:none;border:none;color:var(--gray);font-size:1.5rem;cursor:pointer;padding:0;line-height:1;">&times;</button>
    </div>
    <div style="padding:24px;">
      <div style="display:grid;gap:20px;">
        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Vault Name</label>
          <input type="text" id="byovSettingsName" placeholder="My Home Vault"
            style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;box-sizing:border-box;" />
        </div>

        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">Vault URL</label>
          <input type="url" id="byovSettingsUrl" placeholder="https://vault.example.com"
            style="width:100%;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;box-sizing:border-box;" />
          <p style="margin:8px 0 0 0;color:#f59e0b;font-size:0.8rem;">âš ï¸ Changing the URL will require re-verification.</p>
        </div>

        <div>
          <label style="display:block;margin-bottom:8px;color:var(--text);font-weight:600;">API Key</label>
          <div style="display:flex;gap:8px;">
            <input type="password" id="byovSettingsApiKey" placeholder="Enter new API key (leave blank to keep current)"
              style="flex:1;padding:12px;background:var(--bg-card);border:2px solid #222;border-radius:6px;color:var(--text);font-size:1rem;" />
            <button data-action="clearByovApiKey" class="btn" style="padding:12px;background:#333;white-space:nowrap;" title="Clear API Key">
              Clear
            </button>
          </div>
          <p style="margin:8px 0 0 0;color:var(--gray);font-size:0.8rem;">Current: <span id="byovSettingsApiKeyStatus">Not set</span></p>
        </div>

        <div style="display:flex;align-items:center;gap:12px;">
          <input type="checkbox" id="byovSettingsVerifySsl" checked style="width:20px;height:20px;cursor:pointer;" />
          <label for="byovSettingsVerifySsl" style="color:var(--text);cursor:pointer;">Verify SSL Certificate</label>
        </div>

        <div id="byovSettingsError" style="display:none;padding:12px;background:rgba(244,67,54,0.1);border:1px solid #f44336;border-radius:6px;color:#f44336;font-size:0.9rem;">
        </div>
      </div>
    </div>
    <div style="padding:16px 24px;border-top:2px solid #222;display:flex;gap:12px;justify-content:flex-end;">
      <button data-action="closeByovSettingsModal" class="btn" style="padding:12px 28px;background:#333;font-weight:600;">Cancel</button>
      <button data-action="saveByovSettings" id="saveByovSettingsBtn" class="btn" style="padding:12px 28px;background:linear-gradient(135deg,#10b981 0%,#059669 100%);font-weight:600;">Save Changes</button>
    </div>
  </div>
</div>

<script src="/shared/config.js"></script>
<script src="/account/js/account.js"></script>
</body>
</html>
